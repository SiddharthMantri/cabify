(this.webpackJsonpcabify=this.webpackJsonpcabify||[]).push([[0],[,,,,,,,,function(t,e,a){t.exports=a(16)},,,,,function(t,e,a){},function(t,e,a){},function(t,e,a){},function(t,e,a){"use strict";a.r(e);var n=a(0),r=a.n(n),c=a(7),i=a.n(c),o=(a(13),a(14),a(15),Object(n.createContext)()),s=function(t){var e=t.name,a=void 0===e?"":e,n=t.rule,c=void 0===n?{savings:0}:n;return r.a.createElement("li",null,r.a.createElement("span",null,a),r.a.createElement("span",null," ","-".concat(c.savings," \u20ac")))},u=function(){var t=Object(n.useContext)(o).state,e=t.undiscounted,a=void 0===e?0:e,c=t.grossTotal,i=void 0===c?0:c,u=t.appliedRules,l=void 0===u?{}:u,d=t.cartQty,m=void 0===d?0:d;return r.a.createElement("aside",{className:"summary"},r.a.createElement("h1",{className:"main"},"Order Summary"),r.a.createElement("ul",{className:"summary-items wrapper border"},r.a.createElement("li",null,r.a.createElement("span",{className:"summary-items-number"},m," Items"),r.a.createElement("span",{className:"summary-items-price"},a,r.a.createElement("span",{className:"currency"},"\u20ac")))),r.a.createElement("div",{className:"summary-discounts wrapper-half"},Object.keys(l).length>0&&r.a.createElement(n.Fragment,null,r.a.createElement("h2",null,"Discounts"),r.a.createElement("ul",null,Object.keys(l).map((function(t,e){return r.a.createElement(s,{key:e,name:t,rule:l[t]})}))))),r.a.createElement("div",{className:"summary-total wrapper"},r.a.createElement("h1",{className:"summary-total-cost"},r.a.createElement("span",null,"Total Cost"),r.a.createElement("span",{className:"summary-total-price"},i," \u20ac")),r.a.createElement("button",{type:"submit"},"Checkout")))},l=a(1),d=function(t){var e=t.name,a=void 0===e?"":e,c=t.price,i=void 0===c?0:c,s=t.code,u=void 0===s?"":s,d=t.imgUrl,m=void 0===d?"":d,p=t.imgXlUrl,h=void 0===p?"":p,y=Object(n.useContext)(o),f=y.state,v=y.modal,b=v.setOpen,g=void 0===b?function(){}:b,O=v.setData,E=void 0===O?function(){}:O,j=f.scan,P=f.cart,N=void 0===P?{}:P,w=f.remove,k=f.addByQuantity,q=Object(n.useState)(0),C=Object(l.a)(q,2),D=C[0],x=C[1],S=N[u]?N[u]:{},Q=function(t){return function(e){var a=0,n=parseInt(D);isNaN(n)||("reduce"===t?(a=parseInt(D)<=0?0:parseInt(D)-1,w(u)):(a=parseInt(D)+1,j(u))),x(a)}};return Object(n.useEffect)((function(){var t=N[u]?N[u].qty:0;x(t)}),[f]),r.a.createElement("li",{className:"product row"},r.a.createElement("div",{className:"col-product"},r.a.createElement("figure",{className:"product-image",onClick:function(){g(!0),E({name:a,price:i,code:u,imgUrl:m,imgXlUrl:h})},style:{cursor:"pointer"}},r.a.createElement("img",{src:m,alt:u}),r.a.createElement("div",{className:"product-description"},r.a.createElement("h1",null,a),r.a.createElement("p",{className:"product-code"},"Product code ",u)))),r.a.createElement("div",{className:"col-quantity"},r.a.createElement("button",{className:"count",onClick:Q("reduce")},"-"),r.a.createElement("input",{type:"text",pattern:"[0-9]{1,3}",className:"product-quantity",value:D,onChange:function(t){var e=t.target.validity.valid?t.target.value:D;k(u,e),x(e)},onBlur:function(t){""===t.target.value&&x(0)}}),r.a.createElement("button",{className:"count",onClick:Q("increase")},"+")),r.a.createElement("div",{className:"col-price"},r.a.createElement("span",{className:"product-price"},i),r.a.createElement("span",{className:"product-currency currency"},"\u20ac")),r.a.createElement("div",{className:"col-total"},r.a.createElement("span",{className:"product-price"},S.undiscounted||0),r.a.createElement("span",{className:"product-currency currency"},"\u20ac")))},m=function(t){var e=Object(n.useContext)(o).state.products,a=void 0===e?[]:e;return r.a.createElement(n.Fragment,null,r.a.createElement("ul",{className:"products-list tableHead"},r.a.createElement("li",{className:"products-list-title row"},r.a.createElement("div",{className:"col-product"},"Product details"),r.a.createElement("div",{className:"col-quantity"},"Quantity"),r.a.createElement("div",{className:"col-price"},"Price"),r.a.createElement("div",{className:"col-total"},"Total"))),r.a.createElement("ul",{className:"products-list"},a.map((function(t,e){return r.a.createElement(d,Object.assign({key:e},t))}))))},p=function(t){return r.a.createElement("section",{className:"products"},r.a.createElement("h1",{className:"main"},"Shopping cart"),r.a.createElement(m,null))},h=function(){var t=Object(n.useContext)(o),e=t.modal,a=e.data,c=void 0===a?{}:a,i=e.setOpen,s=void 0===i?function(){}:i,u=e.setData,l=void 0===u?function(){}:u,d=t.state.scan,m=void 0===d?function(){}:d,p=function(){s(!1),l({})};return r.a.createElement(n.Fragment,null,r.a.createElement("section",{className:"products",style:{padding:"0px",position:"relative",overflow:"hidden"}},r.a.createElement("img",{alt:c.name,src:c.imgXlUrl,className:"modal-image"})),r.a.createElement("aside",{className:"summary",style:{background:"#fff"}},r.a.createElement("div",{style:{textAlign:"right",cursor:"pointer"},onClick:p},"x"),r.a.createElement("div",{className:"product-detail-summary"},r.a.createElement("div",{className:"product-detail-box"},r.a.createElement("h1",{className:"product-detail-text"},r.a.createElement("span",{className:"product-title"},c.name),r.a.createElement("span",{className:"product-price"},c.price," \u20ac")),r.a.createElement("p",{className:"product-detail-para"},"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur."),r.a.createElement("p",{className:"product-detail-code"},"Product code ",c.code),r.a.createElement("button",{onClick:function(){m(c.code),p()},type:"submit"},"Add to cart")))))},y=function(){var t=Object(n.useContext)(o).modal.open,e=void 0!==t&&t;return r.a.createElement(n.Fragment,null,e?r.a.createElement(h,null):r.a.createElement(n.Fragment,null,r.a.createElement(p,null),r.a.createElement(u,null)))},f=a(2),v=a(5),b=a(3),g=a(4);function O(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function E(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?O(a,!0).forEach((function(e){Object(f.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):O(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var j=function(){function t(e){Object(b.a)(this,t);var a=e.pricingRules,n=void 0===a?[]:a,r=e.products,c=void 0===r?[]:r;this.cart={},this.products=Object(v.a)(c),this.pricingRules=Object(v.a)(n),this.appliedRules={},this.undiscounted=0,this.grossTotal=0,this.cartQty=0,this.scan=this.scan.bind(this),this.scanProduct=this.scanProduct.bind(this),this.remove=this.remove.bind(this),this.updateCheckout=this.updateCheckout.bind(this),this.total=this.total.bind(this),this.addByQuantity=this.addByQuantity.bind(this)}return Object(g.a)(t,[{key:"calculateCurrentPrice",value:function(t){var e=t.product,a=t.qty,n=(t.undiscounted,t.discounted,e.price);return{product:e,qty:a,undiscounted:n*a,discounted:n*a}}},{key:"scanProduct",value:function(t){this.cart[t.code]?this.cart[t.code].qty+=1:this.cart[t.code]={product:E({},t),qty:1},this.cart[t.code]=this.calculateCurrentPrice(this.cart[t.code]),this.updateCheckout(this.cart)}},{key:"scan",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.products.find((function(e){return e.code===t}));return e&&this.scanProduct(E({},e)),this}},{key:"remove",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.cart[t];e&&e.qty>0&&(e.qty=e.qty-1,this.cart[t]=this.calculateCurrentPrice(this.cart[t])),this.updateCheckout(this.cart)}},{key:"addByQuantity",value:function(t,e){e=""!==e?e:0;var a=parseInt(e),n=this.products.find((function(e){return e.code===t}));this.cart[t]?(this.cart[t].qty=a,this.cart[t].undiscounted=n.price*a):this.cart[t]={product:E({},n),qty:a,undiscounted:n.price*a},this.cart[t]=this.calculateCurrentPrice(this.cart[t]),this.updateCheckout(this.cart)}},{key:"updateCheckout",value:function(t){var e=this;return this.pricingRules.forEach((function(a){a.applyDiscount(t,e.appliedRules)})),this.cart=t,this.cartQty=Object.keys(E({},t)).reduce((function(e,a){return t[a]?e+t[a].qty:0}),0),console.log(this.cartQty),this.grossTotal=Object.keys(E({},t)).reduce((function(e,a){return t[a]?e+t[a].discounted:0}),0),this.undiscounted=Object.keys(E({},t)).reduce((function(e,a){return t[a]?e+t[a].undiscounted:0}),0),Object.assign(Object.create(Object.getPrototypeOf(this)),this)}},{key:"total",value:function(){return this.grossTotal}}]),t}();function P(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function N(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?P(a,!0).forEach((function(e){Object(f.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):P(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function w(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function k(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?w(a,!0).forEach((function(e){Object(f.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):w(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var q=function(){function t(e,a,n,r){Object(b.a)(this,t),this.code=e,this.quantity=a,this.discount=n,this.products=r,this.name="x".concat(this.quantity," ").concat(this.code," Offer")}return Object(g.a)(t,[{key:"getOriginalProductPrice",value:function(t){return this.products.find((function(e){return e.code===t})).price}},{key:"applyDiscount",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=k({},t),n=a[this.code];if(n){var r=n.product.price*n.qty,c=n.product.price*n.qty;if(n&&n.qty>=this.quantity){var i=n.qty*this.discount;c=r-i,e[this.name]={discount:c,savings:r-c}}else n&&n.qty<this.quantity&&delete e[this.name];a[this.code].discounted=c,a[this.code].undiscounted=r}}}]),t}();function C(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function D(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?C(a,!0).forEach((function(e){Object(f.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):C(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var x=function(){function t(e,a){Object(b.a)(this,t),this.code=e,this.quantity=a,this.name="".concat(this.quantity,"x1 Free")}return Object(g.a)(t,[{key:"applyDiscount",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,a=D({},t),n=a[this.code],r=0,c=n&&n.product?n.product.price:0,i=n?c*n.qty:0,o=0,s=n?n.qty:0;if(n&&s>this.quantity)for(var u=this.quantity;u<s;u=u+this.quantity+1)o+=1;if(r=i-c*o,n&&s>this.quantity){n.undiscounted=i,n.discounted=r;var l=i-r;e[this.name]={undiscounted:i,discounted:r,savings:l}}else n&&s<=this.quantity&&delete e[this.name]}}]),t}(),S=function t(e,a,n,r,c){Object(b.a)(this,t),this.code=e,this.name=a,this.price=n,this.imgUrl=r,this.imgXlUrl=c},Q=[new S("TSHIRT","Cabify T-Shirt",20,"./img/shirt.png","./img/tshirt2x.jpg"),new S("MUG","Cabify Coffee Mug",7.5,"./img/mug.png","./img/mug.png"),new S("CAP","Cabify Cap",5,"./img/cap.png","./img/cap.png")],R={pricingRules:[new q("TSHIRT",3,1,Q),new x("CAP",2)],products:Q},T=function(t){var e=t.children,a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new j(t),a=e.cart,r=void 0===a?{}:a,c=e.internalCart,i=void 0===c?{}:c,o=e.products,s=void 0===o?{}:o,u=e.pricingRules,d=void 0===u?{}:u,m=e.appliedRules,p=void 0===m?{}:m,h=e.grossTotal,y=void 0===h?0:h,f=e.scan,v=void 0===f?function(){}:f,b=e.updateCheckout,g=void 0===b?function(){}:b,O=e.undiscounted,E=e.addByQuantity,P=e.remove,w=e.cartQty,k=void 0===w?0:w,q=function(t){var e=t.cart,a=t.undiscounted;T(N({},x,{cart:e,grossTotal:t.grossTotal,appliedRules:t.appliedRules,total:t.total,undiscounted:a,cartQty:t.cartQty}))},C=function(t){return function(e){t(e);var a=g(r);q(a)}},D=function(t){return function(e,a){t(e,a);var n=g(r);q(n)}},x={cart:r,internalCart:i,products:s,pricingRules:d,appliedRules:p,grossTotal:y,scan:C(v),undiscounted:O,addByQuantity:D(E),remove:C(P),cartQty:k},S=Object(n.useState)(x),Q=Object(l.a)(S,2),R=Q[0],T=Q[1];return{state:R}}(R).state,c=function(){var t=Object(n.useState)(!1),e=Object(l.a)(t,2),a=e[0],r=e[1],c=Object(n.useState)({}),i=Object(l.a)(c,2);return[a,i[0],r,i[1]]}(),i=Object(l.a)(c,4),s={open:i[0],data:i[1],setOpen:i[2],setData:i[3]};return r.a.createElement(o.Provider,{value:{state:a,modal:s}},e)};var B=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(T,null,r.a.createElement(y,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(B,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}],[[8,1,2]]]);
//# sourceMappingURL=main.1c3737bd.chunk.js.map