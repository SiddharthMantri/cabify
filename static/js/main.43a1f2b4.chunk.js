(this.webpackJsonpcabify=this.webpackJsonpcabify||[]).push([[0],[,,,,,,,,function(e,t,a){e.exports=a(16)},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(7),i=a.n(c),o=(a(13),a(14),a(15),Object(n.createContext)()),s=function(e){var t=e.item,a=void 0===t?{product:{name:""},qty:0}:t;return a.qty>0?r.a.createElement("li",null,r.a.createElement("span",null,a.product.name),r.a.createElement("span",null,a.qty)):null},u=function(e){var t=e.name,a=void 0===t?"":t,n=e.rule,c=void 0===n?{savings:0}:n;return r.a.createElement("li",null,r.a.createElement("span",null,a),r.a.createElement("span",null," ","-".concat(c.savings,"\u20ac")))},l=function(e){var t=Object(n.useContext)(o).state,a=t.cart,c=void 0===a?{}:a,i=t.undiscounted,l=void 0===i?0:i,d=t.grossTotal,m=void 0===d?0:d,p=t.appliedRules,h=void 0===p?{}:p,y=t.cartQty,f=void 0===y?0:y;return r.a.createElement("aside",{className:"summary"},r.a.createElement("h1",{className:"main"},"Order Summary"),r.a.createElement("ul",{className:"summary-items wrapper"},r.a.createElement("li",null,r.a.createElement("span",{className:"summary-items-number"},f," Items"),r.a.createElement("span",{className:"summary-items-price"},l,r.a.createElement("span",{className:"currency"},"\u20ac")))),f>0&&r.a.createElement("div",{className:"summary-discounts wrapper-half border",style:{padding:"0px 0px 24px 0px",flexGrow:1}},r.a.createElement("ul",null,Object.keys(c).map((function(e,t){return r.a.createElement(s,{key:t,item:c[e]})})))),Object.keys(h).length>0&&r.a.createElement("div",{className:"summary-discounts wrapper-half border"},r.a.createElement("h2",null,"Discounts"),r.a.createElement("ul",null,Object.keys(h).map((function(e,t){return r.a.createElement(u,{key:t,name:e,rule:h[e]})})))),r.a.createElement("div",{className:"summary-total wrapper"},r.a.createElement("h1",{className:"summary-total-cost"},r.a.createElement("span",null,"Total Cost"),r.a.createElement("span",{className:"summary-total-price"},m,"\u20ac")),r.a.createElement("button",{type:"submit"},"Checkout")))},d=a(1),m=function(e){var t=e.name,a=void 0===t?"":t,c=e.price,i=void 0===c?0:c,s=e.code,u=void 0===s?"":s,l=e.imgUrl,m=void 0===l?"":l,p=e.imgXlUrl,h=void 0===p?"":p,y=Object(n.useContext)(o),f=y.state,v=y.modal,b=v.setOpen,g=void 0===b?function(){}:b,O=v.setData,E=void 0===O?function(){}:O,j=f.scan,P=f.cart,N=void 0===P?{}:P,w=f.remove,k=f.addByQuantity,q=Object(n.useState)(0),C=Object(d.a)(q,2),D=C[0],x=C[1],S=N[u]?N[u]:{},Q=function(e){return function(t){var a=0,n=parseInt(D);isNaN(n)||("reduce"===e?(a=parseInt(D)<=0?0:parseInt(D)-1,w(u)):(a=parseInt(D)+1,j(u))),x(a)}};return Object(n.useEffect)((function(){var e=N[u]?N[u].qty:0;x(e)}),[f]),r.a.createElement("li",{className:"product row"},r.a.createElement("div",{className:"col-product"},r.a.createElement("figure",{className:"product-image",onClick:function(){g(!0),E({name:a,price:i,code:u,imgUrl:m,imgXlUrl:h})},style:{cursor:"pointer"}},r.a.createElement("img",{src:m,alt:u}),r.a.createElement("div",{className:"product-description"},r.a.createElement("h1",null,a),r.a.createElement("p",{className:"product-code"},"Product code ",u)))),r.a.createElement("div",{className:"col-quantity"},r.a.createElement("button",{className:"count",onClick:Q("reduce")},"-"),r.a.createElement("input",{type:"text",pattern:"[0-9]{1,3}",className:"product-quantity",value:D,onChange:function(e){var t=e.target.validity.valid?e.target.value:D;k(u,t),x(t)},onBlur:function(e){""===e.target.value&&x(0)}}),r.a.createElement("button",{className:"count",onClick:Q("increase")},"+")),r.a.createElement("div",{className:"col-price"},r.a.createElement("span",{className:"product-price"},i),r.a.createElement("span",{className:"product-currency currency"},"\u20ac")),r.a.createElement("div",{className:"col-total"},r.a.createElement("span",{className:"product-price"},S.undiscounted||0),r.a.createElement("span",{className:"product-currency currency"},"\u20ac")))},p=function(e){var t=Object(n.useContext)(o).state.products,a=void 0===t?[]:t;return r.a.createElement(n.Fragment,null,r.a.createElement("ul",{className:"products-list tableHead"},r.a.createElement("li",{className:"products-list-title row"},r.a.createElement("div",{className:"col-product"},"Product details"),r.a.createElement("div",{className:"col-quantity"},"Quantity"),r.a.createElement("div",{className:"col-price"},"Price"),r.a.createElement("div",{className:"col-total"},"Total"))),r.a.createElement("ul",{className:"products-list"},a.map((function(e,t){return r.a.createElement(m,Object.assign({key:t},e))}))))},h=function(e){return r.a.createElement("section",{className:"products"},r.a.createElement("h1",{className:"main"},"Shopping cart"),r.a.createElement(p,null))},y=function(){var e=Object(n.useContext)(o),t=e.modal,a=t.data,c=void 0===a?{}:a,i=t.setOpen,s=void 0===i?function(){}:i,u=t.setData,l=void 0===u?function(){}:u,d=e.state.scan,m=void 0===d?function(){}:d,p=function(){s(!1),l({})};return r.a.createElement(n.Fragment,null,r.a.createElement("section",{className:"products",style:{padding:"0px",position:"relative",overflow:"hidden"}},r.a.createElement("img",{alt:c.name,src:c.imgXlUrl,className:"modal-image"})),r.a.createElement("aside",{className:"summary",style:{background:"#fff"}},r.a.createElement("div",{style:{textAlign:"right",cursor:"pointer"},onClick:p},"x"),r.a.createElement("div",{className:"product-detail-summary"},r.a.createElement("div",{className:"product-detail-box"},r.a.createElement("h1",{className:"product-detail-text"},r.a.createElement("span",{className:"product-title"},c.name),r.a.createElement("span",{className:"product-price"},c.price," \u20ac")),r.a.createElement("p",{className:"product-detail-para"},"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur."),r.a.createElement("p",{className:"product-detail-code"},"Product code ",c.code),r.a.createElement("button",{onClick:function(){m(c.code),p()},type:"submit"},"Add to cart")))))},f=function(){var e=Object(n.useContext)(o).modal.open,t=void 0!==e&&e;return r.a.createElement(n.Fragment,null,t?r.a.createElement(y,null):r.a.createElement(n.Fragment,null,r.a.createElement(h,null),r.a.createElement(l,null)))},v=a(2),b=a(5),g=a(3),O=a(4);function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(a,!0).forEach((function(t){Object(v.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var P=function(){function e(t){Object(g.a)(this,e);var a=t.pricingRules,n=void 0===a?[]:a,r=t.products,c=void 0===r?[]:r;this.cart={},this.products=Object(b.a)(c),this.pricingRules=Object(b.a)(n),this.appliedRules={},this.undiscounted=0,this.grossTotal=0,this.cartQty=0,this.scan=this.scan.bind(this),this.scanProduct=this.scanProduct.bind(this),this.remove=this.remove.bind(this),this.updateCheckout=this.updateCheckout.bind(this),this.total=this.total.bind(this),this.addByQuantity=this.addByQuantity.bind(this)}return Object(O.a)(e,[{key:"calculateCurrentPrice",value:function(e){var t=e.product,a=e.qty,n=(e.undiscounted,e.discounted,t.price);return{product:t,qty:a,undiscounted:n*a,discounted:n*a}}},{key:"scanProduct",value:function(e){this.cart[e.code]?this.cart[e.code].qty+=1:this.cart[e.code]={product:j({},e),qty:1},this.cart[e.code]=this.calculateCurrentPrice(this.cart[e.code]),this.updateCheckout(this.cart)}},{key:"scan",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.products.find((function(t){return t.code===e}));return t&&this.scanProduct(j({},t)),this}},{key:"remove",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.cart[e];t&&t.qty>0&&(t.qty=t.qty-1,this.cart[e]=this.calculateCurrentPrice(this.cart[e])),this.updateCheckout(this.cart)}},{key:"addByQuantity",value:function(e,t){t=""!==t?t:0;var a=parseInt(t),n=this.products.find((function(t){return t.code===e}));this.cart[e]?(this.cart[e].qty=a,this.cart[e].undiscounted=n.price*a):this.cart[e]={product:j({},n),qty:a,undiscounted:n.price*a},this.cart[e]=this.calculateCurrentPrice(this.cart[e]),this.updateCheckout(this.cart)}},{key:"updateCheckout",value:function(e){var t=this;return this.pricingRules.forEach((function(a){a.applyDiscount(e,t.appliedRules)})),this.cart=e,this.cartQty=Object.keys(j({},e)).reduce((function(t,a){return e[a]?t+e[a].qty:0}),0),console.log(this.cartQty),this.grossTotal=Object.keys(j({},e)).reduce((function(t,a){return e[a]?t+e[a].discounted:0}),0),this.undiscounted=Object.keys(j({},e)).reduce((function(t,a){return e[a]?t+e[a].undiscounted:0}),0),Object.assign(Object.create(Object.getPrototypeOf(this)),this)}},{key:"total",value:function(){return this.grossTotal}}]),e}();function N(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?N(a,!0).forEach((function(t){Object(v.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):N(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(a,!0).forEach((function(t){Object(v.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var C=function(){function e(t,a,n,r){Object(g.a)(this,e),this.code=t,this.quantity=a,this.discount=n,this.products=r,this.name="x".concat(this.quantity," ").concat(this.code," Offer")}return Object(O.a)(e,[{key:"getOriginalProductPrice",value:function(e){return this.products.find((function(t){return t.code===e})).price}},{key:"applyDiscount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=q({},e),n=a[this.code];if(n){var r=n.product.price*n.qty,c=n.product.price*n.qty;if(n&&n.qty>=this.quantity){var i=n.qty*this.discount;c=r-i,t[this.name]={discount:c,savings:r-c}}else n&&n.qty<this.quantity&&delete t[this.name];a[this.code].discounted=c,a[this.code].undiscounted=r}}}]),e}();function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(a,!0).forEach((function(t){Object(v.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var S=function(){function e(t,a){Object(g.a)(this,e),this.code=t,this.quantity=a,this.name="".concat(this.quantity,"x1 Free")}return Object(O.a)(e,[{key:"applyDiscount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=x({},e),n=a[this.code],r=0,c=n&&n.product?n.product.price:0,i=n?c*n.qty:0,o=0,s=n?n.qty:0;if(n&&s>this.quantity)for(var u=this.quantity;u<s;u=u+this.quantity+1)o+=1;if(r=i-c*o,n&&s>this.quantity){n.undiscounted=i,n.discounted=r;var l=i-r;t[this.name]={undiscounted:i,discounted:r,savings:l}}else n&&s<=this.quantity&&delete t[this.name]}}]),e}(),Q=function e(t,a,n,r,c){Object(g.a)(this,e),this.code=t,this.name=a,this.price=n,this.imgUrl=r,this.imgXlUrl=c},R=[new Q("TSHIRT","Cabify T-Shirt",20,"./img/shirt.png","./img/tshirt2x.jpg"),new Q("MUG","Cabify Coffee Mug",7.5,"./img/mug.png","./img/mug.png"),new Q("CAP","Cabify Cap",5,"./img/cap.png","./img/cap.png")],T={pricingRules:[new C("TSHIRT",3,1,R),new S("CAP",2)],products:R},B=function(e){var t=e.children,a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new P(e),a=t.cart,r=void 0===a?{}:a,c=t.internalCart,i=void 0===c?{}:c,o=t.products,s=void 0===o?{}:o,u=t.pricingRules,l=void 0===u?{}:u,m=t.appliedRules,p=void 0===m?{}:m,h=t.grossTotal,y=void 0===h?0:h,f=t.scan,v=void 0===f?function(){}:f,b=t.updateCheckout,g=void 0===b?function(){}:b,O=t.undiscounted,E=t.addByQuantity,j=t.remove,N=t.cartQty,k=void 0===N?0:N,q=function(e){var t=e.cart,a=e.undiscounted;T(w({},x,{cart:t,grossTotal:e.grossTotal,appliedRules:e.appliedRules,total:e.total,undiscounted:a,cartQty:e.cartQty}))},C=function(e){return function(t){e(t);var a=g(r);q(a)}},D=function(e){return function(t,a){e(t,a);var n=g(r);q(n)}},x={cart:r,internalCart:i,products:s,pricingRules:l,appliedRules:p,grossTotal:y,scan:C(v),undiscounted:O,addByQuantity:D(E),remove:C(j),cartQty:k},S=Object(n.useState)(x),Q=Object(d.a)(S,2),R=Q[0],T=Q[1];return{state:R}}(T).state,c=function(){var e=Object(n.useState)(!1),t=Object(d.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)({}),i=Object(d.a)(c,2);return[a,i[0],r,i[1]]}(),i=Object(d.a)(c,4),s={open:i[0],data:i[1],setOpen:i[2],setData:i[3]};return r.a.createElement(o.Provider,{value:{state:a,modal:s}},t)};var I=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(B,null,r.a.createElement(f,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[8,1,2]]]);
//# sourceMappingURL=main.43a1f2b4.chunk.js.map