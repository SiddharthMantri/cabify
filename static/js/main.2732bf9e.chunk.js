(this.webpackJsonpcabify=this.webpackJsonpcabify||[]).push([[0],[,,,,,,,,function(e,t,a){e.exports=a(16)},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(7),i=a.n(c),s=(a(13),a(14),a(15),a(1)),o=Object(n.createContext)(),u=function(e){var t=Object(n.useContext)(o).state,a=Object(n.useState)(0),c=Object(s.a)(a,2),i=c[0],u=c[1],l=t.cart,d=void 0===l?{}:l,p=t.undiscounted,m=void 0===p?0:p,h=t.grossTotal,y=void 0===h?0:h,f=t.appliedRules,v=void 0===f?{}:f;return Object(n.useEffect)((function(){var e=Object.keys(d).reduce((function(e,t){return d[t]?e+d[t].qty:0}),0);u(e)}),[t]),r.a.createElement("aside",{className:"summary"},r.a.createElement("h1",{className:"main"},"Order Summary"),r.a.createElement("ul",{className:"summary-items wrapper border"},r.a.createElement("li",null,r.a.createElement("span",{className:"summary-items-number"},i," Items"),r.a.createElement("span",{className:"summary-items-price"},m,r.a.createElement("span",{className:"currency"},"\u20ac")))),Object.keys(v).length>0&&r.a.createElement("div",{className:"summary-discounts wrapper-half border"},r.a.createElement("h2",null,"Discounts"),r.a.createElement("ul",null,Object.keys(v).map((function(e,t){return r.a.createElement("li",{key:t},r.a.createElement("span",null,e),r.a.createElement("span",null,"-",v[e].savings,"\u20ac"))})))),r.a.createElement("div",{className:"summary-total wrapper"},r.a.createElement("h1",{className:"summary-total-cost"},r.a.createElement("span",null,"Total Cost"),r.a.createElement("span",{className:"summary-total-price"},y,"\u20ac")),r.a.createElement("button",{type:"submit"},"Checkout")))},l=function(e){var t=e.name,a=void 0===t?"":t,c=e.price,i=void 0===c?0:c,u=e.code,l=void 0===u?"":u,d=e.imgUrl,p=void 0===d?"":d,m=e.imgXlUrl,h=void 0===m?"":m,y=Object(n.useContext)(o),f=y.state,v=y.modal,b=v.setOpen,O=void 0===b?function(){}:b,g=v.setData,E=void 0===g?function(){}:g,j=f.scan,P=f.cart,N=void 0===P?{}:P,w=f.remove,k=f.addByQuantity,q=Object(n.useState)(0),C=Object(s.a)(q,2),D=C[0],x=C[1],S=N[l]?N[l]:{},R=function(e){return function(t){var a=0,n=parseInt(D);isNaN(n)||("reduce"===e?(a=parseInt(D)<=0?0:parseInt(D)-1,w(l)):(a=parseInt(D)+1,j(l))),x(a)}};return Object(n.useEffect)((function(){var e=N[l]?N[l].qty:0;x(e)}),[f]),r.a.createElement("li",{className:"product row"},r.a.createElement("div",{className:"col-product"},r.a.createElement("figure",{className:"product-image"},r.a.createElement("img",{src:p,alt:l}),r.a.createElement("div",{className:"product-description"},r.a.createElement("h1",{onClick:function(){O(!0),E({name:a,price:i,code:l,imgUrl:p,imgXlUrl:h})}},a),r.a.createElement("p",{className:"product-code"},"Product code ",l)))),r.a.createElement("div",{className:"col-quantity"},r.a.createElement("button",{className:"count",onClick:R("reduce")},"-"),r.a.createElement("input",{type:"text",pattern:"[0-9]{1,3}",className:"product-quantity",value:D,onChange:function(e){var t=e.target.validity.valid?e.target.value:D;k(l,t),x(t)},onBlur:function(e){""===e.target.value&&x(0)}}),r.a.createElement("button",{className:"count",onClick:R("increase")},"+")),r.a.createElement("div",{className:"col-price"},r.a.createElement("span",{className:"product-price"},i),r.a.createElement("span",{className:"product-currency currency"},"\u20ac")),r.a.createElement("div",{className:"col-total"},r.a.createElement("span",{className:"product-price"},S.undiscounted||0),r.a.createElement("span",{className:"product-currency currency"},"\u20ac")))},d=function(e){var t=Object(n.useContext)(o).state.products,a=void 0===t?[]:t;return r.a.createElement(n.Fragment,null,r.a.createElement("ul",{className:"products-list tableHead"},r.a.createElement("li",{className:"products-list-title row"},r.a.createElement("div",{className:"col-product"},"Product details"),r.a.createElement("div",{className:"col-quantity"},"Quantity"),r.a.createElement("div",{className:"col-price"},"Price"),r.a.createElement("div",{className:"col-total"},"Total"))),r.a.createElement("ul",{className:"products-list"},a.map((function(e,t){return r.a.createElement(l,Object.assign({key:t},e))}))))},p=function(e){return r.a.createElement("section",{className:"products"},r.a.createElement("h1",{className:"main"},"Shopping cart"),r.a.createElement(d,null))},m=function(){var e=Object(n.useContext)(o),t=e.modal,a=t.data,c=void 0===a?{}:a,i=t.setOpen,s=void 0===i?function(){}:i,u=t.setData,l=void 0===u?function(){}:u,d=e.state.scan,p=void 0===d?function(){}:d,m=function(){s(!1),l({})};return r.a.createElement(n.Fragment,null,r.a.createElement("section",{className:"products",style:{padding:"0px",position:"relative",overflow:"hidden"}},r.a.createElement("img",{alt:c.name,src:c.imgXlUrl,className:"modal-image"})),r.a.createElement("aside",{className:"summary",style:{background:"#fff"}},r.a.createElement("div",{style:{textAlign:"right",cursor:"pointer"},onClick:m},"x"),r.a.createElement("div",{className:"product-detail-summary"},r.a.createElement("div",{className:"product-detail-box"},r.a.createElement("h1",{className:"product-detail-text"},r.a.createElement("span",{className:"product-title"},c.name),r.a.createElement("span",{className:"product-price"},c.price," \u20ac")),r.a.createElement("p",{className:"product-detail-para"},"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur."),r.a.createElement("p",{className:"product-detail-code"},"Product code ",c.code),r.a.createElement("button",{onClick:function(){p(c.code),m()},type:"submit"},"Add to cart")))))},h=function(){var e=Object(n.useContext)(o).modal.open,t=void 0!==e&&e;return r.a.createElement(n.Fragment,null,t?r.a.createElement(m,null):r.a.createElement(n.Fragment,null,r.a.createElement(p,null),r.a.createElement(u,null)))},y=a(2),f=a(5),v=a(3),b=a(4);function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(a,!0).forEach((function(t){Object(y.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var E=function(){function e(t){Object(v.a)(this,e);var a=t.pricingRules,n=void 0===a?[]:a,r=t.products,c=void 0===r?[]:r;this.cart={},this.products=Object(f.a)(c),this.pricingRules=Object(f.a)(n),this.appliedRules={},this.undiscounted=0,this.grossTotal=0,this.cartQty=0,this.scan=this.scan.bind(this),this.scanProduct=this.scanProduct.bind(this),this.remove=this.remove.bind(this),this.updateCheckout=this.updateCheckout.bind(this),this.total=this.total.bind(this),this.addByQuantity=this.addByQuantity.bind(this)}return Object(b.a)(e,[{key:"calculateCurrentPrice",value:function(e){var t=e.product,a=e.qty,n=(e.undiscounted,e.discounted,t.price);return{product:t,qty:a,undiscounted:n*a,discounted:n*a}}},{key:"scanProduct",value:function(e){this.cart[e.code]?this.cart[e.code].qty+=1:this.cart[e.code]={product:g({},e),qty:1},this.cart[e.code]=this.calculateCurrentPrice(this.cart[e.code]),this.updateCheckout(this.cart)}},{key:"scan",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.products.find((function(t){return t.code===e}));return t&&this.scanProduct(g({},t)),this}},{key:"remove",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.cart[e];t&&t.qty>0&&(t.qty=t.qty-1,this.cart[e]=this.calculateCurrentPrice(this.cart[e])),this.updateCheckout(this.cart)}},{key:"addByQuantity",value:function(e,t){t=""!==t?t:0;var a=parseInt(t),n=this.products.find((function(t){return t.code===e}));this.cart[e]?(this.cart[e].qty=a,this.cart[e].undiscounted=n.price*a):this.cart[e]={product:g({},n),qty:a,undiscounted:n.price*a},this.cart[e]=this.calculateCurrentPrice(this.cart[e]),this.updateCheckout(this.cart)}},{key:"updateCheckout",value:function(e){var t=this;return this.pricingRules.forEach((function(a){a.applyDiscount(e,t.appliedRules)})),this.cart=e,this.cartQty=Object.keys(g({},e)).reduce((function(t,a){return e[a]?t+e[a].qty:0}),0),this.grossTotal=Object.keys(g({},e)).reduce((function(t,a){return e[a]?t+e[a].discounted:0}),0),this.undiscounted=Object.keys(g({},e)).reduce((function(t,a){return e[a]?t+e[a].undiscounted:0}),0),Object.assign(Object.create(Object.getPrototypeOf(this)),this)}},{key:"total",value:function(){return this.grossTotal}}]),e}();function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function P(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(a,!0).forEach((function(t){Object(y.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function N(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?N(a,!0).forEach((function(t){Object(y.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):N(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var k=function(){function e(t,a,n,r){Object(v.a)(this,e),this.code=t,this.quantity=a,this.discount=n,this.products=r,this.name="x".concat(this.quantity," ").concat(this.code," Offer")}return Object(b.a)(e,[{key:"getOriginalProductPrice",value:function(e){return this.products.find((function(t){return t.code===e})).price}},{key:"applyDiscount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=w({},e),n=a[this.code];if(n){var r=n.product.price*n.qty,c=n.product.price*n.qty;if(n&&n.qty>=this.quantity){var i=n.qty*this.discount;c=r-i,t[this.name]={discount:c,savings:r-c}}else n&&n.qty<this.quantity&&delete t[this.name];a[this.code].discounted=c,a[this.code].undiscounted=r}}}]),e}();function q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?q(a,!0).forEach((function(t){Object(y.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):q(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var D=function(){function e(t,a){Object(v.a)(this,e),this.code=t,this.quantity=a,this.name="".concat(this.quantity,"x1 Free")}return Object(b.a)(e,[{key:"applyDiscount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=C({},e),n=a[this.code],r=0,c=n&&n.product?n.product.price:0,i=n?c*n.qty:0,s=0,o=n?n.qty:0;if(n&&o>this.quantity)for(var u=this.quantity;u<o;u=u+this.quantity+1)s+=1;if(r=i-c*s,n&&o>this.quantity){n.undiscounted=i,n.discounted=r;var l=i-r;t[this.name]={undiscounted:i,discounted:r,savings:l}}else n&&o<=this.quantity&&delete t[this.name]}}]),e}(),x=function e(t,a,n,r,c){Object(v.a)(this,e),this.code=t,this.name=a,this.price=n,this.imgUrl=r,this.imgXlUrl=c},S=[new x("TSHIRT","Cabify T-Shirt",20,"../img/shirt.png","../img/tshirt2x.jpg"),new x("MUG","Cabify Coffee Mug",7.5,"../img/mug.png","../img/mug.png"),new x("CAP","Cabify Cap",5,"../img/cap.png","../img/cap.png")],R={pricingRules:[new k("TSHIRT",3,1,S),new D("CAP",2)],products:S},T=function(e){var t=e.children,a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new E(e),a=t.cart,r=void 0===a?{}:a,c=t.internalCart,i=void 0===c?{}:c,o=t.products,u=void 0===o?{}:o,l=t.pricingRules,d=void 0===l?{}:l,p=t.appliedRules,m=void 0===p?{}:p,h=t.grossTotal,y=void 0===h?0:h,f=t.scan,v=void 0===f?function(){}:f,b=t.updateCheckout,O=void 0===b?function(){}:b,g=t.undiscounted,j=t.addByQuantity,N=t.remove,w=function(e){return function(t){e(t);var a=O(r),n=a.cart,c=a.undiscounted;S(P({},q,{cart:n,grossTotal:a.grossTotal,appliedRules:a.appliedRules,total:a.total,undiscounted:c}))}},k=function(e){return function(t,a){e(t,a);var n=O(r),c=n.cart,i=n.undiscounted;S(P({},q,{cart:c,grossTotal:n.grossTotal,appliedRules:n.appliedRules,total:n.total,undiscounted:i}))}},q={cart:r,internalCart:i,products:u,pricingRules:d,appliedRules:m,grossTotal:y,scan:w(v),undiscounted:g,addByQuantity:k(j),remove:w(N)},C=Object(n.useState)(q),D=Object(s.a)(C,2),x=D[0],S=D[1];return{state:x}}(R).state,c=function(){var e=Object(n.useState)(!1),t=Object(s.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)({}),i=Object(s.a)(c,2);return[a,i[0],r,i[1]]}(),i=Object(s.a)(c,4),u={open:i[0],data:i[1],setOpen:i[2],setData:i[3]};return r.a.createElement(o.Provider,{value:{state:a,modal:u}},t)};var B=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(T,null,r.a.createElement(h,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(B,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[8,1,2]]]);
//# sourceMappingURL=main.2732bf9e.chunk.js.map